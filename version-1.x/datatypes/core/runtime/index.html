<!doctype html>
<html class="docs-version-1.x" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="search" type="application/opensearchdescription+xml" title="ZIO" href="/opensearch.xml">
<link rel="stylesheet" href="/css/prism/prism-material-dark.css"><title data-react-helmet="true">Runtime | ZIO</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://zio.dev/version-1.x/datatypes/core/runtime"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="1.x"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-1.x"><meta data-react-helmet="true" property="og:title" content="Runtime | ZIO"><meta data-react-helmet="true" name="description" content="A Runtime[R] is capable of executing tasks within an environment R."><meta data-react-helmet="true" property="og:description" content="A Runtime[R] is capable of executing tasks within an environment R."><link data-react-helmet="true" rel="icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://zio.dev/version-1.x/datatypes/core/runtime"><link data-react-helmet="true" rel="alternate" href="https://zio.dev/version-1.x/datatypes/core/runtime" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://zio.dev/version-1.x/datatypes/core/runtime" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.eb47feb5.css">
<link rel="preload" href="/assets/js/runtime~main.576d5781.js" as="script">
<link rel="preload" href="/assets/js/main.3950424f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/navbar_brand.png" alt="ZIO" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/navbar_brand.png" alt="ZIO" class="themedImage_W2Cr themedImage--dark_oUvU"></div></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/version-1.x/overview/">Overview</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/version-1.x/datatypes/">Data Types</a><a class="navbar__item navbar__link" href="/version-1.x/usecases/">Use Cases</a><a class="navbar__item navbar__link" href="/version-1.x/howto/">How to</a><a class="navbar__item navbar__link" href="/version-1.x/resources/">Resources</a><a class="navbar__item navbar__link" href="/version-1.x/about/">About</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/version-1.x/overview/">ZIO 1.x</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/next/datatypes/core/runtime">ZIO 2.x (WIP)</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/version-1.x/datatypes/core/runtime">ZIO 1.x</a></li></ul></div><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/version-1.x/datatypes/">Overview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/version-1.x/datatypes/core/">Core Data Types</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/version-1.x/datatypes/core/">Summary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/version-1.x/datatypes/core/zio">ZIO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/version-1.x/datatypes/core/uio">UIO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/version-1.x/datatypes/core/urio">URIO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/version-1.x/datatypes/core/task">Task</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/version-1.x/datatypes/core/rio">RIO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/version-1.x/datatypes/core/io">IO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/version-1.x/datatypes/core/exit">Exit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/version-1.x/datatypes/core/cause">Cause</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/version-1.x/datatypes/core/runtime">Runtime</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/version-1.x/datatypes/contextual/">Contextual Types</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/version-1.x/datatypes/fiber/">Fiber Primitives</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/version-1.x/datatypes/concurrency/">Concurrency Primitives</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/version-1.x/datatypes/stm/">STM</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/version-1.x/datatypes/resource/">Resource Safety</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/version-1.x/datatypes/stream/">Streaming</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/version-1.x/datatypes/misc/">Miscellaneous</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->ZIO 1.x</span><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Runtime</h1></header><p>A <code>Runtime[R]</code> is capable of executing tasks within an environment <code>R</code>.</p><p>To run an effect, we need a <code>Runtime</code>, which is capable of executing effects. Runtimes bundle a thread pool together with the environment that effects need.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="what-is-a-runtime-system">What is a Runtime System?<a class="hash-link" href="#what-is-a-runtime-system" title="Direct link to heading">â€‹</a></h2><p>Whenever we write a ZIO program, we create a ZIO effect from ZIO constructors plus using its combinators. We are building a blueprint. ZIO effect is just a data structure that describes the execution of a concurrent program. So we end up with a tree data structure that contains lots of different data structures combined together to describe what the ZIO effect should do. This data structure doesn&#x27;t do anything, it is just a description of a concurrent program.</p><p>So the most thing we should keep in mind when we are working with a functional effect system like ZIO is that when we are writing code, printing a string onto the console, reading a file, querying a database, and so forth; We are just writing a workflow or blueprint of an application. We are just building a data structure.</p><p>So how ZIO run these workflows? This is where ZIO Runtime System comes into play. Whenever we run an <code>unsaferun</code> function, the Runtime System is responsible to step through all the instructions described by the ZIO effect and execute them.</p><p>To simplify everything, we can think of a Runtime System like a black box that takes both the ZIO effect (<code>ZIO[R, E, A]</code>) and its environment (<code>R</code>), it will run this effect and then will return its result as an <code>Either[E, A]</code> value.</p><p><img alt="ZIO Runtime System" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSI0MjciIGhlaWdodD0iMTU3IiB2aWV3Qm94PSItMC41IC0wLjUgNDI3IDE1NyIgY29udGVudD0iJmx0O214ZmlsZSBob3N0PSZxdW90O2FwcC5kaWFncmFtcy5uZXQmcXVvdDsgbW9kaWZpZWQ9JnF1b3Q7MjAyMS0wNS0wM1QxNDoxMzowNi45MDVaJnF1b3Q7IGFnZW50PSZxdW90OzUuMCAoWDExOyBMaW51eCB4ODZfNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS84Ny4wLjQyODAuNjYgU2FmYXJpLzUzNy4zNiZxdW90OyBldGFnPSZxdW90O3ZsZEdNX2syRDh5LU9jMFNXaFJaJnF1b3Q7IHZlcnNpb249JnF1b3Q7MTQuNi45JnF1b3Q7IHR5cGU9JnF1b3Q7ZGV2aWNlJnF1b3Q7Jmd0OyZsdDtkaWFncmFtIGlkPSZxdW90OzBsamJtNVJSenR3YlJuZzVERlNyJnF1b3Q7IG5hbWU9JnF1b3Q7UGFnZS0xJnF1b3Q7Jmd0OzdWZE5qOW93RVAwMWtkckRTb2tEQVk3QTBnKzFWYXVscTBxOXVjbVFHSnlZT2hNZy9mV2R4QTVKZ04xdTFkMVdXcFVEMkc4bVkvdTltWEZ3L0hsNmVLMzVOdm1nSXBBT2M2T0Q0MTg3akkzR2pMNHJvRFRBd1BNTkVHc1JHY2hyZ2FYNEFSWjBMVnFJQ1BLZUl5b2xVV3o3WUtpeURFTHNZVnhydGUrN3JaVHNyN3JsTVp3Qnk1RExjL1NMaURBeDZKaU5XdndOaURocFZ2YUNpYkY4NCtFbTFxckk3SG9PODFmMXg1aFQzc1N5QjgwVEhxbDlCL0lYamovWFNxRVpwWWM1eUlyYWhqYnozS3M3ck1kOWE4andJUThFNVhSeXUzUEg2eUxjdlF2WmFwMHRQMSt4d0lUWmNWbEFjNDU2dDFnMkROVm5oQ3FLNi9pemZTSVFsbHNlVnRZOXBRUmhDYWFTWmg0Tkk1NG50Vzh6K2NRUlFXYzF3dHdCb1VjaXFuRDVCakJNN0NTV1BNL3RzNHFXRUZoYWk5MGxhSVREbmVmM2pxeFNzb0pLQVhWSkxzMERnUlhDSnFvM3R2TjlLL3VnRVN2cFNqNjBJTGVwRmg5anQzVFR3REwrTyt5elg3TVBFYVdyblNxTmlZcFZ4dVdpUldkOWZWcWY5MHB0TFpsclFDeHQ3ZkVDVlY4enMyYTEwUDNVMHI1VW9VTzQ1MFJOQlhNZEE5N25ON3FzbFFiSlVlejZHM2w4M2dmL2FmNExOSHNYc2p1UXROL1pTdEdKdS93SDN3dlZHSzd5bXNFcE9YaUQ3YUUxMGlpdWZyKysvVWkybXlKRGtRS05sbVdPa0RheGFhc212SEgrczNiVzYxV1AwSVI4dDkrRWp0ZGdwd2tkRzFXM0NVMmVxZ2Q1azJmWGc0S0hWc2MvTFk3em0vZkZqY01vbUZ2bDkzQm1Kd3Z6TTNXRzF5L1BoS0ZFeEpPRVJhMDJNRmRTYVVJeWxWWHFySVNVSnhDWElxNHU1WkRvQmNKblZWb0xlaTJhV2tNcW9xaVc5bEtGOU9WK2dzdVpEWWJuZGVGZXFBdjJaSFV4T3RObklUQWhyb2F6amliUFY1TGhhYXU2SU1uNGNSU2hhZnNlWE5zNi96WDh4VTg9Jmx0Oy9kaWFncmFtJmd0OyZsdDsvbXhmaWxlJmd0OyIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6IHJnYigyNTUsIDI1NSwgMjU1KTsiPjxkZWZzPjxsaW5lYXJHcmFkaWVudCB4MT0iMCUiIHkxPSIwJSIgeDI9IjAlIiB5Mj0iMTAwJSIgaWQ9Im14LWdyYWRpZW50LWZmZmZmZi0wLjktZmZmZmZmLTAuMS1zLTAiPjxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNmZmZmZmY7c3RvcC1vcGFjaXR5OjAuOSIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6I2ZmZmZmZjtzdG9wLW9wYWNpdHk6MC4xIi8+PC9saW5lYXJHcmFkaWVudD48ZmlsdGVyIGlkPSJkcm9wU2hhZG93Ij48ZmVHYXVzc2lhbkJsdXIgaW49IlNvdXJjZUFscGhhIiBzdGREZXZpYXRpb249IjEuNyIgcmVzdWx0PSJibHVyIi8+PGZlT2Zmc2V0IGluPSJibHVyIiBkeD0iMyIgZHk9IjMiIHJlc3VsdD0ib2Zmc2V0Qmx1ciIvPjxmZUZsb29kIGZsb29kLWNvbG9yPSIjM0Q0NTc0IiBmbG9vZC1vcGFjaXR5PSIwLjQiIHJlc3VsdD0ib2Zmc2V0Q29sb3IiLz48ZmVDb21wb3NpdGUgaW49Im9mZnNldENvbG9yIiBpbjI9Im9mZnNldEJsdXIiIG9wZXJhdG9yPSJpbiIgcmVzdWx0PSJvZmZzZXRCbHVyIi8+PGZlQmxlbmQgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0ib2Zmc2V0Qmx1ciIvPjwvZmlsdGVyPjwvZGVmcz48ZyBmaWx0ZXI9InVybCgjZHJvcFNoYWRvdykiPjxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSI0MjAiIGhlaWdodD0iMTUwIiBmaWxsLW9wYWNpdHk9IjAiIGZpbGw9IiNmZmZmZmYiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAiIHN0cm9rZS1kYXNoYXJyYXk9IjEgNCIgcG9pbnRlci1ldmVudHM9ImFsbCIvPjxwYXRoIGQ9Ik0gLTEgLTEgTCAtMSA2MCBRIDIxMCAxMDUgNDIxIDYwIEwgNDIxIC0xIFoiIGZpbGwtb3BhY2l0eT0iMCIgZmlsbD0idXJsKCNteC1ncmFkaWVudC1mZmZmZmYtMC45LWZmZmZmZi0wLjEtcy0wKSIgc3Ryb2tlPSJub25lIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PHBhdGggZD0iTSAzMDAgNzUgTCAzMzMuNjMgNzUiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ic3Ryb2tlIi8+PHBhdGggZD0iTSAzMzguODggNzUgTCAzMzEuODggNzguNSBMIDMzMy42MyA3NSBMIDMzMS44OCA3MS41IFoiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PHBhdGggZD0iTSAzMDAgNzUgTCAzMzMuNjMgNzUiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ic3Ryb2tlIi8+PHBhdGggZD0iTSAzMzguODggNzUgTCAzMzEuODggNzguNSBMIDMzMy42MyA3NSBMIDMzMS44OCA3MS41IFoiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PHJlY3QgeD0iMTQwIiB5PSIzMCIgd2lkdGg9IjE2MCIgaGVpZ2h0PSI5MCIgZmlsbD0iI2ZmZmZmZiIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTAuNSAtMC41KSI+PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6IHZpc2libGU7IHRleHQtYWxpZ246IGxlZnQ7IiBwb2ludGVyLWV2ZW50cz0ibm9uZSIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IHVuc2FmZSBjZW50ZXI7IGp1c3RpZnktY29udGVudDogdW5zYWZlIGNlbnRlcjsgd2lkdGg6IDE1OHB4OyBoZWlnaHQ6IDFweDsgcGFkZGluZy10b3A6IDc1cHg7IG1hcmdpbi1sZWZ0OiAxNDFweDsiPjxkaXYgc3R5bGU9ImJveC1zaXppbmc6IGJvcmRlci1ib3g7IGZvbnQtc2l6ZTogMDsgdGV4dC1hbGlnbjogY2VudGVyOyAiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogIzAwMDAwMDsgbGluZS1oZWlnaHQ6IDEuMjsgcG9pbnRlci1ldmVudHM6IGFsbDsgd2hpdGUtc3BhY2U6IG5vcm1hbDsgd29yZC13cmFwOiBub3JtYWw7ICI+PGZvbnQgc3R5bGU9ImZvbnQtc2l6ZTogMTRweCI+WklPIFJ1bnRpbWUgU3lzdGVtPC9mb250PjwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIyMjAiIHk9Ijc5IiBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIiBmb250LXNpemU9IjEycHgiIHRleHQtYW5jaG9yPSJtaWRkbGUiPlpJTyBSdW50aW1lIFN5c3RlbTwvdGV4dD48L3N3aXRjaD48L2c+PHBhdGggZD0iTSAxMDAgNzUgTCAxMzMuNjMgNzUiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ic3Ryb2tlIi8+PHBhdGggZD0iTSAxMzguODggNzUgTCAxMzEuODggNzguNSBMIDEzMy42MyA3NSBMIDEzMS44OCA3MS41IFoiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PHJlY3QgeD0iMCIgeT0iNjUiIHdpZHRoPSIxMDAiIGhlaWdodD0iMjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0ibm9uZSIgcG9pbnRlci1ldmVudHM9ImFsbCIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0wLjUgLTAuNSkiPjxzd2l0Y2g+PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OiB2aXNpYmxlOyB0ZXh0LWFsaWduOiBsZWZ0OyIgcG9pbnRlci1ldmVudHM9Im5vbmUiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiB1bnNhZmUgY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IHVuc2FmZSBjZW50ZXI7IHdpZHRoOiA5OHB4OyBoZWlnaHQ6IDFweDsgcGFkZGluZy10b3A6IDc1cHg7IG1hcmdpbi1sZWZ0OiAxcHg7Ij48ZGl2IHN0eWxlPSJib3gtc2l6aW5nOiBib3JkZXItYm94OyBmb250LXNpemU6IDA7IHRleHQtYWxpZ246IGNlbnRlcjsgIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6ICMwMDAwMDA7IGxpbmUtaGVpZ2h0OiAxLjI7IHBvaW50ZXItZXZlbnRzOiBhbGw7IHdoaXRlLXNwYWNlOiBub3JtYWw7IHdvcmQtd3JhcDogbm9ybWFsOyAiPihSLCBaSU9bUiwgRSwgQV0pPC9kaXY+PC9kaXY+PC9kaXY+PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjUwIiB5PSI3OSIgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSIgZm9udC1zaXplPSIxMnB4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj4oUiwgWklPW1IsIEUsIEFdKTwvdGV4dD48L3N3aXRjaD48L2c+PHJlY3QgeD0iMzQwIiB5PSI2NSIgd2lkdGg9IjgwIiBoZWlnaHQ9IjIwIiBmaWxsPSJub25lIiBzdHJva2U9Im5vbmUiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC41IC0wLjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzogdmlzaWJsZTsgdGV4dC1hbGlnbjogbGVmdDsiIHBvaW50ZXItZXZlbnRzPSJub25lIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogdW5zYWZlIGNlbnRlcjsganVzdGlmeS1jb250ZW50OiB1bnNhZmUgY2VudGVyOyB3aWR0aDogNzhweDsgaGVpZ2h0OiAxcHg7IHBhZGRpbmctdG9wOiA3NXB4OyBtYXJnaW4tbGVmdDogMzQxcHg7Ij48ZGl2IHN0eWxlPSJib3gtc2l6aW5nOiBib3JkZXItYm94OyBmb250LXNpemU6IDA7IHRleHQtYWxpZ246IGNlbnRlcjsgIj48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6ICMwMDAwMDA7IGxpbmUtaGVpZ2h0OiAxLjI7IHBvaW50ZXItZXZlbnRzOiBhbGw7IHdoaXRlLXNwYWNlOiBub3JtYWw7IHdvcmQtd3JhcDogbm9ybWFsOyAiPkVpdGhlcltFLCBBXTwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIzODAiIHk9Ijc5IiBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIiBmb250LXNpemU9IjEycHgiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkVpdGhlcltFLCBBXTwvdGV4dD48L3N3aXRjaD48L2c+PC9nPjxzd2l0Y2g+PGcgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ii8+PGEgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwtNSkiIHhsaW5rOmhyZWY9Imh0dHBzOi8vd3d3LmRpYWdyYW1zLm5ldC9kb2MvZmFxL3N2Zy1leHBvcnQtdGV4dC1wcm9ibGVtcyIgdGFyZ2V0PSJfYmxhbmsiPjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTBweCIgeD0iNTAlIiB5PSIxMDAlIj5WaWV3ZXIgZG9lcyBub3Qgc3VwcG9ydCBmdWxsIFNWRyAxLjE8L3RleHQ+PC9hPjwvc3dpdGNoPjwvc3ZnPg==" width="427" height="157"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="responsibilities-of-the-runtime-system">Responsibilities of the Runtime System<a class="hash-link" href="#responsibilities-of-the-runtime-system" title="Direct link to heading">â€‹</a></h2><p>Runtime Systems have a lot of responsibilities:</p><ol><li><p><strong>Execute every step of the blueprint</strong> â€” They have to execute every step of the blueprint in a while loop until it&#x27;s done.</p></li><li><p><strong>Handle unexpected errors</strong> â€” They have to handle unexpected errors, not just the expected ones but also the unexpected ones. </p></li><li><p><strong>Spawn concurrent fiber</strong> â€” They are actually responsible for the concurrency that effect systems have. They have to spawn a fiber every time we call <code>fork</code> on an effect to spawn off a new fiber.</p></li><li><p><strong>Cooperatively yield to other fibers</strong> â€” They have to cooperatively yield to other fibers so that fibers that are sort of hogging the spotlight, don&#x27;t get to monopolize all the CPU resources. They have to make sure that the fibers split the CPU cores among all the fibers that are working.</p></li><li><p><strong>Capture execution and stack traces</strong> â€” They have to keep track of where we are in the progress of our own user-land code so the nice detailed execution traces can be captured. </p></li><li><p><strong>Ensure finalizers are run appropriately</strong> â€” They have to ensure finalizers are run appropriately at the right point in all circumstances to make sure that resources are closed that clean-up logic is executed. This is the feature that powers ZManaged and all the other resource-safe constructs in ZIO.</p></li><li><p><strong>Handle asynchronous callback</strong> â€” They have to handle this messy job of dealing with asynchronous callbacks. So we don&#x27;t have to deal with async code. When we are doing ZIO, everything is just async out of the box. </p></li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="running-a-zio-effect">Running a ZIO Effect<a class="hash-link" href="#running-a-zio-effect" title="Direct link to heading">â€‹</a></h2><p>There are two ways to run ZIO effect:</p><ol><li><strong>Using <code>zio.App</code> entry point</strong></li><li><strong>Using <code>unsafeRun</code> method directly</strong></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="using-zioapp">Using zio.App<a class="hash-link" href="#using-zioapp" title="Direct link to heading">â€‹</a></h3><p>In most cases we use this method to run our ZIO effect. <code>zio.App</code> has a <code>run</code> function which is the main entry point for running a ZIO application on the JVM:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">package zio</span><br></span><span class="token-line"><span class="token plain">trait App {</span><br></span><span class="token-line"><span class="token plain">  def run(args: List[String]): URIO[ZEnv, ExitCode]</span><br></span><span class="token-line"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Assume we have written an effect using ZIO:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">import zio.console._</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">def myAppLogic =</span><br></span><span class="token-line"><span class="token plain">  for {</span><br></span><span class="token-line"><span class="token plain">    _ &lt;- putStrLn(&quot;Hello! What is your name?&quot;)</span><br></span><span class="token-line"><span class="token plain">    n &lt;- getStrLn</span><br></span><span class="token-line"><span class="token plain">    _ &lt;- putStrLn(&quot;Hello, &quot; + n + &quot;, good to meet you!&quot;)</span><br></span><span class="token-line"><span class="token plain">  } yield ()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Now we can run that effect using <code>run</code> entry point:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">object MyApp extends zio.App {</span><br></span><span class="token-line"><span class="token plain">  final def run(args: List[String]) =</span><br></span><span class="token-line"><span class="token plain">    myAppLogic.exitCode</span><br></span><span class="token-line"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="using-unsaferun">Using unsafeRun<a class="hash-link" href="#using-unsaferun" title="Direct link to heading">â€‹</a></h3><p>Another way to execute ZIO effect is to feed the ZIO effect to the <code>unsafeRun</code> method of Runtime system:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">object RunZIOEffectUsingUnsafeRun extends scala.App {</span><br></span><span class="token-line"><span class="token plain">  zio.Runtime.default.unsafeRun(</span><br></span><span class="token-line"><span class="token plain">    myAppLogic</span><br></span><span class="token-line"><span class="token plain">  )</span><br></span><span class="token-line"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>We don&#x27;t usually use this method to run our effects. One of the use cases of this method is when we are integrating the legacy (non-effectful code) with the ZIO effect. It also helps us to refactor a large legacy code base into a ZIO effect gradually; Assume we have decided to refactor a component in the middle of a legacy code and rewrite that with ZIO. We can start rewriting that component with the ZIO effect and then integrate that component with the existing code base, using the <code>unsafeRun</code> function.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="default-runtime">Default Runtime<a class="hash-link" href="#default-runtime" title="Direct link to heading">â€‹</a></h2><p>ZIO contains a default runtime called <code>Runtime.default</code>, configured with the <code>ZEnv</code> (the default ZIO environment) and a default <code>Platform</code> designed to work well for mainstream usage. It is already implemented as below:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">object Runtime {</span><br></span><span class="token-line"><span class="token plain">  lazy val default: Runtime[ZEnv] = Runtime(ZEnv.Services.live, Platform.default)</span><br></span><span class="token-line"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The default runtime includes a default <code>Platform</code> which contains minimum capabilities to bootstrap execution of ZIO tasks and live (production) versions of all ZIO built-in services. The default ZIO environment (<code>ZEnv</code>) for the <code>JS</code> platform includes <code>Clock</code>, <code>Console</code>, <code>System</code>, <code>Random</code>; and the <code>JVM</code> platform also has a <code>Blocking</code> service:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">// Default JS environment</span><br></span><span class="token-line"><span class="token plain">type ZEnv = Clock with Console with System with Random</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">// Default JVM environment</span><br></span><span class="token-line"><span class="token plain">type ZEnv = Clock with Console with System with Random with Blocking</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>We can easily access the default <code>Runtime</code> to run an effect:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">object MainApp extends scala.App {</span><br></span><span class="token-line"><span class="token plain">  val runtime = Runtime.default</span><br></span><span class="token-line"><span class="token plain">  runtime.unsafeRun(myAppLogic)</span><br></span><span class="token-line"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="custom-runtime">Custom Runtime<a class="hash-link" href="#custom-runtime" title="Direct link to heading">â€‹</a></h2><p>Sometimes we need to create a custom <code>Runtime</code> with a user-defined environment and user-specified <code>Platform</code>. Many real applications should not use <code>Runtime.default</code>. Instead, they should make their own <code>Runtime</code> which configures the <code>Platform</code> and environment accordingly.</p><p>Some use-cases of custom Runtimes:</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="providing-environment-to-runtime-system">Providing Environment to Runtime System<a class="hash-link" href="#providing-environment-to-runtime-system" title="Direct link to heading">â€‹</a></h3><p>The custom runtime can be used to run many different effects that all require the same environment, so we don&#x27;t have to call <code>ZIO#provide</code> on all of them before we run them.</p><p>For example, assume we want to create a <code>Runtime</code> for services that are for testing purposes, and they don&#x27;t interact with real external APIs. So we can create a runtime, especially for testing.</p><p>Let&#x27;s say we have defined two <code>Logging</code> and <code>Email</code> services:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">trait Logging {</span><br></span><span class="token-line"><span class="token plain">  def log(line: String): UIO[Unit]</span><br></span><span class="token-line"><span class="token plain">}</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">object Logging {</span><br></span><span class="token-line"><span class="token plain">  def log(line: String): URIO[Has[Logging], Unit] =</span><br></span><span class="token-line"><span class="token plain">    ZIO.serviceWith[Logging](_.log(line))</span><br></span><span class="token-line"><span class="token plain">}</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">trait Email {</span><br></span><span class="token-line"><span class="token plain">  def send(user: String, content: String): Task[Unit]</span><br></span><span class="token-line"><span class="token plain">}</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">object Email {</span><br></span><span class="token-line"><span class="token plain">  def send(user: String, content: String): ZIO[Has[Email], Throwable, Unit] =</span><br></span><span class="token-line"><span class="token plain">    ZIO.serviceWith[Email](_.send(user, content))</span><br></span><span class="token-line"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>We are going to implement a live version of <code>Logging</code> service and also a mock version of <code>Email</code> service for testing:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">case class LoggingLive() extends Logging {</span><br></span><span class="token-line"><span class="token plain">  override def log(line: String): UIO[Unit] =</span><br></span><span class="token-line"><span class="token plain">    ZIO.effectTotal(print(line))</span><br></span><span class="token-line"><span class="token plain">}</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">case class EmailMock() extends Email {</span><br></span><span class="token-line"><span class="token plain">  override def send(user: String, content: String): Task[Unit] =</span><br></span><span class="token-line"><span class="token plain">    ZIO.effect(println(s&quot;sending email to $user&quot;))</span><br></span><span class="token-line"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Let&#x27;s create a custom runtime that contains these two service implementations in its environment:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">val testableRuntime = Runtime(</span><br></span><span class="token-line"><span class="token plain">  Has.allOf[Logging, Email](LoggingLive(), EmailMock()),</span><br></span><span class="token-line"><span class="token plain">  Platform.default</span><br></span><span class="token-line"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Also, we can map the default runtime to the new runtime, so we can append new services to the default ZIO environment:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">val testableRuntime: Runtime[zio.ZEnv with Has[Logging] with Has[Email]] =</span><br></span><span class="token-line"><span class="token plain">  Runtime.default</span><br></span><span class="token-line"><span class="token plain">    .map((zenv: zio.ZEnv) =&gt;</span><br></span><span class="token-line"><span class="token plain">      zenv ++ Has.allOf[Logging, Email](LoggingLive(), EmailMock())</span><br></span><span class="token-line"><span class="token plain">    )</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Now we can run our effects using this custom <code>Runtime</code>:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">testableRuntime.unsafeRun(</span><br></span><span class="token-line"><span class="token plain">  for {</span><br></span><span class="token-line"><span class="token plain">    _ &lt;- Logging.log(&quot;sending newsletter&quot;)</span><br></span><span class="token-line"><span class="token plain">    _ &lt;- Email.send(&quot;David&quot;, &quot;Hi! Here is today&#x27;s newsletter.&quot;)</span><br></span><span class="token-line"><span class="token plain">  } yield ()</span><br></span><span class="token-line"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="application-monitoring">Application Monitoring<a class="hash-link" href="#application-monitoring" title="Direct link to heading">â€‹</a></h3><p>Sometimes to diagnose runtime issues and understand what is going on in our application we need to add some sort of monitoring task to the Runtime System. It helps us to track fibers and their status.</p><p>By adding a <code>Supervisor</code> to the current platform of the Runtime System, we can track the activity of fibers in a program. So every time a fiber gets started, forked, or every time a fiber ends its life, all these contextual pieces of information get reported to that <code>Supervisor</code>.</p><p>For example, the <a href="https://zio.github.io/zio-zmx/" target="_blank" rel="noopener noreferrer">ZIO ZMX</a> enables us to monitor our ZIO application. To include that in our project we must add the following line to our <code>build.sbt</code>:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">libraryDependencies += &quot;dev.zio&quot; %% &quot;zio-zmx&quot; % &quot;0.0.6&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>ZIO ZMX has a specialized <code>Supervisor</code> called <code>ZMXSupervisor</code> that can be added to our existing <code>Runtime</code>:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">import zio._</span><br></span><span class="token-line"><span class="token plain">import zio.console._</span><br></span><span class="token-line"><span class="token plain">import zio.zmx._</span><br></span><span class="token-line"><span class="token plain">import zio.zmx.diagnostics._</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">val program: ZIO[Console, Throwable, Unit] =</span><br></span><span class="token-line"><span class="token plain">  for {</span><br></span><span class="token-line"><span class="token plain">    _ &lt;- putStrLn(&quot;Waiting for input&quot;)</span><br></span><span class="token-line"><span class="token plain">    a &lt;- getStrLn</span><br></span><span class="token-line"><span class="token plain">    _ &lt;- putStrLn(&quot;Thank you for &quot; + a)</span><br></span><span class="token-line"><span class="token plain">  } yield ()</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">val diagnosticsLayer: ZLayer[ZEnv, Throwable, Has[Diagnostics]] =</span><br></span><span class="token-line"><span class="token plain">  Diagnostics.make(&quot;localhost&quot;, 1111)</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">val runtime: Runtime[ZEnv] =</span><br></span><span class="token-line"><span class="token plain">  Runtime.default.mapPlatform(_.withSupervisor(ZMXSupervisor))</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">runtime.unsafeRun(program.provideCustomLayer(diagnosticsLayer))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="application-tracing">Application Tracing<a class="hash-link" href="#application-tracing" title="Direct link to heading">â€‹</a></h3><p>We can enable or disable execution tracing or configure its setting. Execution tracing has full of junk. There are lots of allocations that all need to be garbage collected afterward. So it has a tremendous impact on the complexity of the application runtime.</p><p>Users often turn off tracing in critical areas of their application. Also, when we are doing benchmark operation, it is better to create a <code>Runtime</code> without tracing capability:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">import zio.internal.Tracing</span><br></span><span class="token-line"><span class="token plain">import zio.internal.tracing.TracingConfig</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">val rt1 = Runtime.default.mapPlatform(_.withTracing(Tracing.disabled))</span><br></span><span class="token-line"><span class="token plain">val rt2 = Runtime.default.mapPlatform(_.withTracing(Tracing.enabledWith(TracingConfig.stackOnly)))</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">val config = TracingConfig(</span><br></span><span class="token-line"><span class="token plain">  traceExecution = true,</span><br></span><span class="token-line"><span class="token plain">  traceEffectOpsInExecution = true,</span><br></span><span class="token-line"><span class="token plain">  traceStack = true,</span><br></span><span class="token-line"><span class="token plain">  executionTraceLength = 100,</span><br></span><span class="token-line"><span class="token plain">  stackTraceLength = 100,</span><br></span><span class="token-line"><span class="token plain">  ancestryLength = 10,</span><br></span><span class="token-line"><span class="token plain">  ancestorExecutionTraceLength = 10,</span><br></span><span class="token-line"><span class="token plain">  ancestorStackTraceLength = 10</span><br></span><span class="token-line"><span class="token plain">)</span><br></span><span class="token-line"><span class="token plain">val rt3 = Runtime.default.mapPlatform(_.withTracingConfig(config))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="user-defined-executor">User-defined Executor<a class="hash-link" href="#user-defined-executor" title="Direct link to heading">â€‹</a></h3><p>An executor is responsible for executing effects. The way how each effect will be run including detail of threading, scheduling, and so forth, is separated from the caller. So, if we need to have a specialized executor according to our requirements, we can provide that to the ZIO <code>Runtime</code>:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">import zio.internal.Executor</span><br></span><span class="token-line"><span class="token plain">import java.util.concurrent.{ThreadPoolExecutor, TimeUnit, LinkedBlockingQueue}</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">val runtime = Runtime.default.mapPlatform(</span><br></span><span class="token-line"><span class="token plain">  _.withExecutor(</span><br></span><span class="token-line"><span class="token plain">    Executor.fromThreadPoolExecutor(_ =&gt; 1024)(</span><br></span><span class="token-line"><span class="token plain">      new ThreadPoolExecutor(</span><br></span><span class="token-line"><span class="token plain">        5,</span><br></span><span class="token-line"><span class="token plain">        10,</span><br></span><span class="token-line"><span class="token plain">        5000,</span><br></span><span class="token-line"><span class="token plain">        TimeUnit.MILLISECONDS,</span><br></span><span class="token-line"><span class="token plain">        new LinkedBlockingQueue[Runnable]()</span><br></span><span class="token-line"><span class="token plain">      )</span><br></span><span class="token-line"><span class="token plain">    )</span><br></span><span class="token-line"><span class="token plain">  )</span><br></span><span class="token-line"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="benchmarking">Benchmarking<a class="hash-link" href="#benchmarking" title="Direct link to heading">â€‹</a></h3><p>To do benchmark operation, we need a <code>Runtime</code> with settings suitable for that. It would be better to disable tracing and auto-yielding. ZIO has a built-in <code>Platform</code> proper for benchmark operations, called <code>Platform.benchmark</code> which we can map the default <code>Platform</code> to the benchmark version:</p><div class="codeBlockContainer_I0IT language-scala theme-code-block"><div class="codeBlockContent_wNvx scala"><pre tabindex="0" class="prism-code language-scala codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line"><span class="token plain">val benchmarkRuntime = Runtime.default.mapPlatform(_ =&gt; Platform.benchmark)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/zio/zio/edit/series/2.x/versioned_docs/version-1.x/datatypes/core/runtime.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/version-1.x/datatypes/core/cause"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Cause</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/version-1.x/datatypes/contextual/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Introduction</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-a-runtime-system" class="table-of-contents__link toc-highlight">What is a Runtime System?</a></li><li><a href="#responsibilities-of-the-runtime-system" class="table-of-contents__link toc-highlight">Responsibilities of the Runtime System</a></li><li><a href="#running-a-zio-effect" class="table-of-contents__link toc-highlight">Running a ZIO Effect</a><ul><li><a href="#using-zioapp" class="table-of-contents__link toc-highlight">Using zio.App</a></li><li><a href="#using-unsaferun" class="table-of-contents__link toc-highlight">Using unsafeRun</a></li></ul></li><li><a href="#default-runtime" class="table-of-contents__link toc-highlight">Default Runtime</a></li><li><a href="#custom-runtime" class="table-of-contents__link toc-highlight">Custom Runtime</a><ul><li><a href="#providing-environment-to-runtime-system" class="table-of-contents__link toc-highlight">Providing Environment to Runtime System</a></li><li><a href="#application-monitoring" class="table-of-contents__link toc-highlight">Application Monitoring</a></li><li><a href="#application-tracing" class="table-of-contents__link toc-highlight">Application Tracing</a></li><li><a href="#user-defined-executor" class="table-of-contents__link toc-highlight">User-defined Executor</a></li><li><a href="#benchmarking" class="table-of-contents__link toc-highlight">Benchmarking</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items"><li class="footer__item">
                <img src="/img/navbar_brand.png" alt="zio">
            </li></ul></div><div class="col footer__col"><div class="footer__title">Github</div><ul class="footer__items"><li class="footer__item">
              <a href="https://github.com/zio/zio">
                <img src="https://img.shields.io/github/stars/zio/zio?style=social" alt="github">
              </a>
            </li></ul></div><div class="col footer__col"><div class="footer__title">Chat with us on Discord</div><ul class="footer__items"><li class="footer__item">
                <a href="https://discord.gg/2ccFBr4">
                  <img src="https://img.shields.io/discord/629491597070827530?logo=discord&style=social" alt="discord">
                </a>
              </li></ul></div><div class="col footer__col"><div class="footer__title">Follow us on Twitter</div><ul class="footer__items"><li class="footer__item">
                <a href="https://twitter.com/zioscala">
                  <img src="https://img.shields.io/twitter/follow/zioscala?label=Follow&style=social" alt="twitter">
                </a>
              </li></ul></div><div class="col footer__col"><div class="footer__title">Additional resources</div><ul class="footer__items"><li class="footer__item"><a href="https://javadoc.io/doc/dev.zio/zio_2.12/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Scaladoc of ZIO<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 ZIO Maintainers - Built with <a href="https://v2.docusaurus.io/">Docusaurus v2</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.576d5781.js"></script>
<script src="/assets/js/main.3950424f.js"></script>
</body>
</html>